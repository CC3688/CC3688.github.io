<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础 | CC3688 blog</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Just playing around">
    <link rel="preload" href="/assets/css/0.styles.1b5c6595.css" as="style"><link rel="preload" href="/assets/js/app.a761fdad.js" as="script"><link rel="preload" href="/assets/js/2.f625eefe.js" as="script"><link rel="preload" href="/assets/js/19.57d5157d.js" as="script"><link rel="prefetch" href="/assets/js/10.9276f3bc.js"><link rel="prefetch" href="/assets/js/11.b682676a.js"><link rel="prefetch" href="/assets/js/12.e93f1a58.js"><link rel="prefetch" href="/assets/js/13.c670705b.js"><link rel="prefetch" href="/assets/js/14.3afc9644.js"><link rel="prefetch" href="/assets/js/15.ce0ec2af.js"><link rel="prefetch" href="/assets/js/16.0c8fed25.js"><link rel="prefetch" href="/assets/js/17.70f271e7.js"><link rel="prefetch" href="/assets/js/18.325e0978.js"><link rel="prefetch" href="/assets/js/20.c4a7a36b.js"><link rel="prefetch" href="/assets/js/21.d185011b.js"><link rel="prefetch" href="/assets/js/22.b6cd295c.js"><link rel="prefetch" href="/assets/js/23.077bd992.js"><link rel="prefetch" href="/assets/js/24.241b12cb.js"><link rel="prefetch" href="/assets/js/25.f8d57d84.js"><link rel="prefetch" href="/assets/js/26.2ca22227.js"><link rel="prefetch" href="/assets/js/27.e11e823c.js"><link rel="prefetch" href="/assets/js/28.50281ac8.js"><link rel="prefetch" href="/assets/js/29.1fce1f13.js"><link rel="prefetch" href="/assets/js/3.48bf621d.js"><link rel="prefetch" href="/assets/js/30.9c96825f.js"><link rel="prefetch" href="/assets/js/31.12c3998e.js"><link rel="prefetch" href="/assets/js/32.fb94fa3c.js"><link rel="prefetch" href="/assets/js/33.bd9b462f.js"><link rel="prefetch" href="/assets/js/34.58ac7858.js"><link rel="prefetch" href="/assets/js/35.b55b61d6.js"><link rel="prefetch" href="/assets/js/36.245f58ef.js"><link rel="prefetch" href="/assets/js/37.d025f029.js"><link rel="prefetch" href="/assets/js/38.d197d8d0.js"><link rel="prefetch" href="/assets/js/39.b7e1ce60.js"><link rel="prefetch" href="/assets/js/4.97b1d945.js"><link rel="prefetch" href="/assets/js/40.0c1a84a9.js"><link rel="prefetch" href="/assets/js/41.d4afa780.js"><link rel="prefetch" href="/assets/js/42.121cbf6d.js"><link rel="prefetch" href="/assets/js/43.0479770a.js"><link rel="prefetch" href="/assets/js/44.d7c52248.js"><link rel="prefetch" href="/assets/js/45.d1b8ece5.js"><link rel="prefetch" href="/assets/js/46.0da90371.js"><link rel="prefetch" href="/assets/js/47.3ba8bcd7.js"><link rel="prefetch" href="/assets/js/48.b2dc0303.js"><link rel="prefetch" href="/assets/js/49.61cc678b.js"><link rel="prefetch" href="/assets/js/5.63cb3433.js"><link rel="prefetch" href="/assets/js/50.712e3a95.js"><link rel="prefetch" href="/assets/js/51.3e671530.js"><link rel="prefetch" href="/assets/js/6.345a20a1.js"><link rel="prefetch" href="/assets/js/7.57211556.js"><link rel="prefetch" href="/assets/js/8.e8f7270a.js"><link rel="prefetch" href="/assets/js/9.68af55ab.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1b5c6595.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">CC3688 blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/JS/" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/TS/" class="nav-link">
  TS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/" class="nav-link">
  tools
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/Node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/backend/PHP/" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/backend/Python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/backend/MySQL/" class="nav-link">
  MySQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/framework/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/framework/Adonis/" class="nav-link">
  Adonis
</a></li><li class="dropdown-item"><!----> <a href="/framework/Laravel/" class="nav-link">
  Laravel
</a></li><li class="dropdown-item"><!----> <a href="/framework/Django/" class="nav-link router-link-active">
  Django
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="移动" class="dropdown-title"><span class="title">移动</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mobile/小程序/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/mobile/RN/" class="nav-link">
  RN
</a></li><li class="dropdown-item"><!----> <a href="/mobile/Flutter/" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/jingguan/" class="nav-link">
  经管
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/JS/" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/TS/" class="nav-link">
  TS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/" class="nav-link">
  tools
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/Node/" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/backend/PHP/" class="nav-link">
  PHP
</a></li><li class="dropdown-item"><!----> <a href="/backend/Python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/backend/MySQL/" class="nav-link">
  MySQL
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/framework/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/framework/Adonis/" class="nav-link">
  Adonis
</a></li><li class="dropdown-item"><!----> <a href="/framework/Laravel/" class="nav-link">
  Laravel
</a></li><li class="dropdown-item"><!----> <a href="/framework/Django/" class="nav-link router-link-active">
  Django
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="移动" class="dropdown-title"><span class="title">移动</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mobile/小程序/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/mobile/RN/" class="nav-link">
  RN
</a></li><li class="dropdown-item"><!----> <a href="/mobile/Flutter/" class="nav-link">
  Flutter
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/jingguan/" class="nav-link">
  经管
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/framework/Django/" class="sidebar-link">Django</a></li><li><a href="/framework/Django/基础.html" class="active sidebar-link">基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#开启项目" class="sidebar-link">开启项目</a></li><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#静态文件配置" class="sidebar-link">静态文件配置</a></li><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#路由控制" class="sidebar-link">路由控制</a></li><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#视图" class="sidebar-link">视图</a></li><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#模板" class="sidebar-link">模板</a></li><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#orm" class="sidebar-link">ORM</a></li><li class="sidebar-sub-header"><a href="/framework/Django/基础.html#表的基础操作" class="sidebar-link">表的基础操作</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基础"><a href="#基础" class="header-anchor">#</a> 基础</h1> <h2 id="开启项目"><a href="#开启项目" class="header-anchor">#</a> 开启项目</h2> <h4 id="安装django"><a href="#安装django" class="header-anchor">#</a> 安装Django</h4> <div class="language- extra-class"><pre class="language-text"><code>&gt; pip3 install django
</code></pre></div><h4 id="创建一个django-project"><a href="#创建一个django-project" class="header-anchor">#</a> 创建一个django project</h4> <div class="language- extra-class"><pre class="language-text"><code>&gt; django-admin.py startproject mysite
</code></pre></div><p><strong>mysite目录结构</strong></p> <div class="language- extra-class"><pre class="language-text"><code>|-- mysite
    |-- manage.py
    |-- mysite            
        |-- __init__.py
        |-- settings.py
        |-- urls.py
        |-- wsgi.py
</code></pre></div><ul><li>里的mysite 与 外面的mysite 名字可以不相同,默认创建是相同的,里面的mysit是和整个项目相关的</li> <li>manage.py :　Django项目里面的工具, 通过它可以调用django shell 和 数据库</li> <li>settings.py :　包含了项目的默认设置,包括数据库信息,调试标志及其他一些工作变量</li> <li>urls.py :　负责把url模式映射到应用程序
1.15 06分</li></ul> <h4 id="创建一个应用"><a href="#创建一个应用" class="header-anchor">#</a> 创建一个应用</h4> <div class="language- extra-class"><pre class="language-text"><code>&gt; python manage.py startapp blog

|-- mysite
    |-- blog
        |-- migrations
        |-- __init__.py
        |-- admin.py
        |-- apps.py
        |-- models.py
        |-- tests.py
        |-- views.py
    |-- manage.py
    |-- mysite            
        |-- __init__.py
        |-- settings.py
        |-- urls.py
        |-- wsgi.py

</code></pre></div><ul><li>blog 文件是和应用相关的东西</li> <li>models.py 模型</li> <li>views.py 视图函数</li></ul> <h4 id="新建视图文件夹"><a href="#新建视图文件夹" class="header-anchor">#</a> 新建视图文件夹</h4> <p>手动在根目录下创建一个 templates 文件夹, 根据应用再创建相应的文件夹</p> <p>并在 项目 settings.py TEMPLATES.DIRS 下添加目录</p> <div class="language- extra-class"><pre class="language-text"><code>TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': ['templates'],                    
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]
</code></pre></div><h4 id="mtv"><a href="#mtv" class="header-anchor">#</a> MTV</h4> <p>http请求后, 由 项目的 urls.py 分配 视图函数 views,   views 或与models 联系, 然后, 调用 templates 下相应的模板</p> <h4 id="启动项目"><a href="#启动项目" class="header-anchor">#</a> 启动项目</h4> <div class="language- extra-class"><pre class="language-text"><code>&gt; python manage.py runserver 8888
</code></pre></div><ul><li>8888 是端口号, 不填,默认是8000</li> <li>会默认生成一个 db.sqlite3  数据库存相关</li></ul> <h2 id="静态文件配置"><a href="#静态文件配置" class="header-anchor">#</a> 静态文件配置</h2> <p>在项目根目录 新建 static 文件夹 , 并找到 项目 settings.py</p> <p>把路径添加上去</p> <div class="language- extra-class"><pre class="language-text"><code>// 这个是原有的代码            这个是 将在模板引用时 的 url 如: /static/jQuery.js
STATIC_URL = '/static/'

// 这个手动添加的代码
STATICFILES_DIRS = [
    os.path.join(BASE_DIR, &quot;static&quot;)    // &quot;static&quot; 新建的静态文件目录, 可以随便起名
]

//这样写,  STATIC_URL 这个不要动, 
// 实际目录,手动添加的可以随便动
</code></pre></div><h2 id="路由控制"><a href="#路由控制" class="header-anchor">#</a> 路由控制</h2> <p>在urlps.py 里配置路由,  2.0 支持 path写法, 也支持 1.0的re_path写法</p> <h4 id="简单的路由配置"><a href="#简单的路由配置" class="header-anchor">#</a> 简单的路由配置</h4> <p>urls.py</p> <div class="language- extra-class"><pre class="language-text"><code>urlpatterns = [
    path('admin/', admin.site.urls),
    path('timer/', views.timer),

    # 路由配置:　　路径　　－－－－－－－＞　视图函数
    # 从上到下 匹配, 如果匹配了就不往下走了
    re_path(r'^articles/2003/$', views.specical_case_2003),
    # 这里正则匹配上了,就调用,后面的函数,并传一个请求对象做参数request,
    # 它有所有的请求信息, 一定要写,不管你用不用
     re_path(r'^articles/([0-9]{4})/$', views.year_archive),
     # 括号正则分组, 匹配到时, 会把它 作为request之后的第二个参数传入
     # 位置参数,你可以自已随便用个参数接收它
     re_path(r'^articles/([0-9]{4})/([0-9]{2})/$', views.month_archive),
     
     # 要从url中捕获一个值, 只需要在它周围放置一对圆括号
     # 不需要添加一个前导反斜杠
     # 每个正则表达式前面的'r' 是可选的, 建议加上
]
</code></pre></div><p>views.py</p> <div class="language- extra-class"><pre class="language-text"><code>from django.shortcuts import render, HttpResponse

def specical_case_2003(request):

    return HttpResponse(&quot;111&quot;)

def year_archive(request, year):

    return HttpResponse(year)

def month_archive(request, year, month):

    return HttpResponse(year + '--' + month)
</code></pre></div><h4 id="有名分组"><a href="#有名分组" class="header-anchor">#</a> 有名分组</h4> <p>上面的 分组是没有名字的, 靠位置参数 获得值,也可以给它起个命名</p> <div class="language- extra-class"><pre class="language-text"><code># urls.py
re_path(r'^articles/(?P&lt;y&gt;[0-9]{4})/(?P&lt;m&gt;[0-9]{2})/$', views.month_archive),

# views.py
def month_archive(request, y, m):
    # 这里就必须用 y, m 来接收了, 因为它是关键字传参, 谁先谁后就无所谓了
    # y, m 数据类型  是字符串,   
    # urls 传过来的都是字符串, 如果想要像数字那样去处理 需要转类型, path定义的urls则解决这个问题
    return HttpResponse(year)
</code></pre></div><h4 id="路由分发"><a href="#路由分发" class="header-anchor">#</a> 路由分发</h4> <p>路由应该 每个应用写一个urls.py  然后, 由项目的urls.py 去做分发</p> <p>可以在每个应用 下创建一个 urls.py</p> <p>blog 应用下创建 urls.py</p> <div class="language- extra-class"><pre class="language-text"><code>from django.contrib import admin
from django.urls import path, re_path
from blog import views

urlpatterns = [
    re_path(r'^articles/2003/$', views.specical_case_2003),
    re_path(r'^articles/([0-9]{4})/$', views.year_archive),
    re_path(r'^articles/(?P&lt;y&gt;[0-9]{4})/(?P&lt;m&gt;[0-9]{2})/$', views.month_archive),
]
</code></pre></div><p>在项目urls.py下做分发</p> <div class="language- extra-class"><pre class="language-text"><code>from django.contrib import admin
from django.urls import path, re_path, include


# 需要先引入include

urlpatterns = [
    path('admin/', admin.site.urls),

    # 分发:
    re_path(r'blog/', include(&quot;blog.urls&quot;)),
    # re_path(r'^', include(&quot;blog.urls&quot;)),  这样也可以的,这各之前写的没分发一样了
]
</code></pre></div><p>现在是这样访问:　http://localhost:8080/blog/articles/2076/80/
当匹配到 blog 就被分发到 blog下的 urls 下去处理剩下的路由(articles/2076/80/)</p> <h4 id="密码登录示例"><a href="#密码登录示例" class="header-anchor">#</a> 密码登录示例</h4> <p>注意先关闭一下 csrf   在项目 设置里的 中间件字段</p> <p>url.py</p> <div class="language- extra-class"><pre class="language-text"><code>re_path(r'^login/$', views.login)

</code></pre></div><p>前端html</p> <div class="language- extra-class"><pre class="language-text"><code>    // action 不写,就表示 提交到当前也  
    // 如果以 / 开头,则是 表示当前域名加端口后, 再加上之后的路径
    &lt;form action=&quot;http://127.0.0.1:8000/blog/login/&quot; method=&quot;POST&quot;&gt;
        用户名 &lt;input type=&quot;text&quot; name=&quot;user&quot;&gt;
        密码 &lt;input type=&quot;password&quot; name=&quot;pwd&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;
    &lt;/form&gt;
</code></pre></div><p>views.py</p> <div class="language- extra-class"><pre class="language-text"><code>def login(request):
    // 通过 请求方法的判断  然后 做出不同的响应
    if request.method == 'GET':
        return render(request, 'blog/login.html')
    
    else: 
        user = request.POST.get('user')
        pwd = request.POST.get('pwd')

        if user == 'yycu' and pwd == '123456':
            return HttpResponse(&quot;登录成功&quot;)
        else:
            return HttpResponse(&quot;密码或账号错误&quot;)
</code></pre></div><h4 id="路由反向解析-命名路由"><a href="#路由反向解析-命名路由" class="header-anchor">#</a> 路由反向解析  --  命名路由</h4> <p>路由是一个可能随时被改的东西, 一但改了,其它地方也得改, 相当麻烦.
可以在定义路由是传入一个关键字参灵敏 name='yourURLname'</p> <p>urls.py</p> <div class="language- extra-class"><pre class="language-text"><code>re_path(r'^login/$', views.login, name='login'),

</code></pre></div><p>html这样用</p> <div class="language- extra-class"><pre class="language-text"><code> &lt;form action=&quot;{% url 'login' %}&quot; method=&quot;POST&quot;&gt;

 //这里为什么样呢?
 // 因为在 渲染这个页面时, render时, {% url 'login' %}  模板语法,会被解析为相应的url
 // 它会先在 项目里的 urls.py 里找 ,然后找不到 再到 应用里的找
</code></pre></div><p>在视图函数使用</p> <div class="language- extra-class"><pre class="language-text"><code>from django.urls import reverse

def viewFunction(request):

    url = reverse('url_name')
    // 拿到后,就可以使用了
    // 如果解析出来,含有 正则表达式, 可以第二个参数去替换,不然后报找不到
    // url = reverse('year', args=(2003,))      
    // 元组中有一个元素的写法是(元素,),  不然会被当做 (元素)  就不是元组了
</code></pre></div><h4 id="路由名称空间-命名空间"><a href="#路由名称空间-命名空间" class="header-anchor">#</a> 路由名称空间(命名空间)</h4> <p>多个应用, 对路由进行命名, 很大概率会出现重复命名的情况, 发生覆盖现象.</p> <p>可以用名称空间来解决, 在路由分发时使用</p> <div class="language- extra-class"><pre class="language-text"><code>// 在项目urls.py 引入各应用urls.py 时, 通过关键字参数 namespace 指定一个命名空间
// re_path(r'blog/', include((&quot;blog.urls&quot;, &quot;namespace&quot;))),   要用元组来传
re_path(r'blog/', include((&quot;blog.urls&quot;, &quot;blog&quot;))),

</code></pre></div><p>开启了名称空间后,  以后 reverse 时 需要这样</p> <div class="language- extra-class"><pre class="language-text"><code>reverse('namespace:name')        // 注意语法 :
reverse('blog:name')   
</code></pre></div><h4 id="path-方法"><a href="#path-方法" class="header-anchor">#</a> path 方法</h4> <p>django2.0 新增的path 方法</p> <ul><li>原先1.0版本的, re_path  传过来的路由参数, 都是字符串,即使 是数字,其实也是 &quot;11123&quot; 其实也是一个数字字符串</li> <li>正则有可以能重复也同样的正则多次</li></ul> <p>path 方法</p> <div class="language- extra-class"><pre class="language-text"><code>urlpatterns = [
    path('articles/2003/', views.special_case_2003),
    path('articles/&lt;int:year&gt;/', views.year_archive),
    path('articles/&lt;int:year&gt;/&lt;int:month&gt;', views.special_case_2003),
    path('articles/&lt;int:year&gt;/&lt;int:month&gt;/&lt;slug&gt;', views.article_detail),
]
// 使用 &lt;&gt;    从url 中捕获值
// 这里的int 是django 提供的一个转化器类型, 没写就是得到的是字符串
// : 后时 参数名,  没有用int: 则&lt;argname&gt;   &lt;&gt;里的内容 是参数名
// 转换器有:
// str     捕获的都是 字符串   默认的
// int     匹配正整数, 包含0
// slug    匹配字母,数字及横杠,下划线组成的字符串
// uuid    匹配格式化的uuid 如: 075194d3-6775-478e-a8a8-6c931e288f00
// path    匹配任何非空字符串, 包含了路径分隔符    
</code></pre></div><p>自定义转换器</p> <p>// 在 app/urlconver.py</p> <div class="language- extra-class"><pre class="language-text"><code>class MonConvert: 

    regex = &quot;[0-9]{2}&quot;   // 固定属性, 一定要这样的属性

    def to_python(self, value):
        return int(value)
    
    def to_url(self, value):    # 反向解析
        return '%04d' % value
</code></pre></div><p>使用转换器</p> <p>在项目的 urls.py</p> <div class="language- extra-class"><pre class="language-text"><code>from django.urls import register_converter    //需要引入转换器注册函数
from app.urlconver import MonConvert

// 先注册                         别名是必须的
register_converter(MonConvert, '起个别名方便使用k:mm')

 path('articles/&lt;mm:month&gt;/', views.month_archive),
</code></pre></div><p>**django1.0版本都是用 url来定义了, 只要把re_path换成url  其它都是一样的</p> <h2 id="视图"><a href="#视图" class="header-anchor">#</a> 视图</h2> <p>一个视图函数, 简称视图,是一个简单的python函数,它接受web请求并返回web响应. 它一定要有一个返回值.</p> <h4 id="request"><a href="#request" class="header-anchor">#</a> request</h4> <ul><li>request.method  请求方式</li> <li>request.GET     get请求的数据   是一个字典   通过 get('key')  取值</li> <li>request.POST    post请求的数据  是一个字典   通过 get('key')  取值</li> <li>request.path    路径,  不包含 协议,域名,端口号,数据</li> <li>request.get_full_path() 路径和数据  不包含 协议,域名,端口号</li></ul> <p>还有很多.....</p> <h4 id="respone"><a href="#respone" class="header-anchor">#</a> respone</h4> <p>视图函数,返回的 就是response</p> <ul><li>return HttpResponse('字符串')</li> <li>return render(request, 'html文件', [数据]); 数据是一个字典</li></ul> <h2 id="模板"><a href="#模板" class="header-anchor">#</a> 模板</h2> <h4 id="模板语法"><a href="#模板语法" class="header-anchor">#</a> 模板语法</h4> <p>templates 目录下的就是模板, 含 html 和 模板语法</p> <p><strong>两个模板语法</strong></p> <ul><li>    两个大括号是渲染表量用的
<ul><li>1 深度查询    句点符</li> <li>2 过滤器</li></ul></li> <li>{% %}    渲染标签用的</li></ul> <p>views.py</p> <div class="language- extra-class"><pre class="language-text"><code>def index(request):

    name = '陈俊武'
    i = 10
    l = [11, 22, 33]
    info = {&quot;name&quot;: &quot;yycu3688&quot;, &quot;age&quot;: 22}
    b = True
    class Person(object):
        def __init__(self, name, age):
            self.name = name
            self.age = age
    cc = Person(&quot;cc&quot;, 333)
    cjw = Person(&quot;cjw&quot;, 444)

    person_list = [cc, cjw]


    return render(request, 'index.html', {'name': name, 'i': i, 'l': l, 'info': info, 'cc': cc, 'cjw': cjw, 'person_list': person_list})

    # 这种写法太累了
    # return render(request, 'index.html', locals())  locals会把变量,和上面的一样传递守去

</code></pre></div><p>index.html</p> <div class="language- extra-class"><pre class="language-text"><code>
    &lt;h2&gt;index.html&lt;/h2&gt;
    &lt;p&gt;名字: {{ name }}&lt;/p&gt;
    &lt;p&gt;{{i}}&lt;/p&gt;
    &lt;p&gt;{{info}}&lt;/p&gt;
   
     &lt;h2&gt;深度查询&lt;/h2&gt;
     &lt;p&gt;{{cc.name}}&lt;/p&gt;
     &lt;p&gt;{{person_list.1.age}}&lt;/p&gt;

     # 起别名
     {% with person_list.1.age as age %}
     接下来 ane 就是 等于 person_list.1.age

</code></pre></div><h4 id="过滤器"><a href="#过滤器" class="header-anchor">#</a> 过滤器</h4> <p>语法:</p> <div class="language- extra-class"><pre class="language-text"><code>{{ obj | filter_name: param }}
</code></pre></div><h4 id="标签"><a href="#标签" class="header-anchor">#</a> 标签</h4> <p>在模板 html</p> <div class="language- extra-class"><pre class="language-text"><code># 循环    和python for 循环一样   
{% for i in l %}
    &lt;p&gt;{{ i }}&lt;/p&gt;
{% endfor %}

# 循环 计数器  django 模板语法提供的 从 1  开始
{% for i in l %}
    &lt;p&gt;{{ forloop.counter }}&lt;/p&gt;   // 从 1  开始
    &lt;p&gt;{{ forloop.counter0 }}&lt;/p&gt;  // 从 0 开始
{% endfor %}


# django 提供一个empty
{% for i in l %}
    &lt;p&gt;{{ forloop.counter }}&lt;/p&gt;   // 从 1  开始
    &lt;p&gt;{{ forloop.counter0 }}&lt;/p&gt;  // 从 0 开始
{% empty %}
&lt;p&gt;列表为空&lt;/p&gt;
{% endfor %}


# if 条件语句

{% if user %}
&lt;p&gt;
    CC3688你好
&lt;/p&gt;
{% else %}
&lt;p&gt;
    登录
&lt;/p&gt;

{% endif %}

# scsf

表单提交时时要在 form 内添加上下面这句:

{% csrf_token %}     # 会生成一个默认 的隐藏的表单域


</code></pre></div><h4 id="自定义标签-和-过滤器"><a href="#自定义标签-和-过滤器" class="header-anchor">#</a> 自定义标签 和 过滤器</h4> <p>1 在settings中的installed_apps 配置当前app, 不然django无法找到自定义的标签</p> <p>2 在app中创建templatetags模块(模块名只能是templatetags)    # 名字不能换, django 认死的,  模块就一个文件件,带__init__.py</p> <p>3 创建任意.py文件, 如 my_tags_filter.py</p> <div class="language- extra-class"><pre class="language-text"><code>from django import template   # 固定写法

register = template.Library() # 固定写法

@register.filter              # 固定写法
def multi_fliter(x, y):       # 自定义一个过滤器  过滤器,最多只能定义两个形参, 因为它的调用形式决定了
    return x*y


@register.simple_tag          # 自定义标签  形参个数无限
def multi_tag(x, y):
    return x*y

</code></pre></div><p>4 使用时需要先引入</p> <div class="language- extra-class"><pre class="language-text"><code>{% load my_tags_filter %}
&lt;p&gt;{{i | multi_filter}}


&lt;p&gt;{% multi_tag 7 9 %}&lt;/p&gt;
</code></pre></div><h4 id="模板继承"><a href="#模板继承" class="header-anchor">#</a> 模板继承</h4> <div class="language- extra-class"><pre class="language-text"><code># base.html

{% block title %}
&lt;title&gt;orders&lt;/title&gt;
{% endblock title%}

{% block con %}     # 留坑
{{ block.super }}   # 会把父类的内容也留下, 而不是只被覆盖  即子类继承时, &lt;h4&gt;订单&lt;/h4&gt; 也会被保留
&lt;h4&gt;订单&lt;/h4&gt;
{% endblock con%}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>
{% include 'advertise.html' %}     # 引入 html  include 只是引入, 没有像继承那有坑可填


</code></pre></div><p>继承模板</p> <div class="language- extra-class"><pre class="language-text"><code>{% extends 'base.html %}

{% block con  %}
    填坑
{%  endblock  %}

</code></pre></div><h2 id="orm"><a href="#orm" class="header-anchor">#</a> ORM</h2> <p>ORM 实现了数据模型与数据库的解藕, 即数据模型的设计不需要依赖于特定的数据库,
通过简单的配置就可以轻松更换数据库
ORM 是 对象 - 关系 - 映射   的简称</p> <p>有的需要安装 下列的依赖
不同版本可能会遇到不到的问题</p> <p>pipenv install mysqlclient</p> <ol><li>定义表    在models.py 文件定义</li></ol> <div class="language- extra-class"><pre class="language-text"><code>from django.db import models

# Create your models here.
class Book(models.Model):
    id = models.AutoField(primary_key=True)
    title = models.CharField(max_length=32)
    pub_date = models.DateField()
    price = models.DecimalField(max_digits=8, decimal_places=2)
    publish = models.CharField(max_length=32)
</code></pre></div><ol start="2"><li>设置 数据相关的 在settings.py 设置</li></ol> <div class="language- extra-class"><pre class="language-text"><code>DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'db',
        'USER': 'yycu',
        'PASSWORD': '001001001',
        'HOST': '127.0.0.1',
        'PORT': 3306
    }
}
</code></pre></div><ol start="3"><li>设置 logging 非必须 在settings.py 设置</li></ol> <div class="language- extra-class"><pre class="language-text"><code>LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
        },
    },
   'loggers': {
        'django.db.backends': {
            'handlers': ['console'],
            'propagate': True,
        }
   }
}
</code></pre></div><ol start="4"><li>生成迁移文件</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&gt;python manage.py makemigrations
</code></pre></div><ol start="5"><li>迁移</li></ol> <p>生成表</p> <div class="language- extra-class"><pre class="language-text"><code>&gt; python manage.py migrate
</code></pre></div><h2 id="表的基础操作"><a href="#表的基础操作" class="header-anchor">#</a> 表的基础操作</h2> <h4 id="表添加"><a href="#表添加" class="header-anchor">#</a> 表添加</h4> <div class="language- extra-class"><pre class="language-text"><code>from django.shortcuts import render, HttpResponse

from app.models import Book      # 引入模型类

def index(request):

    # 添加表记录

    # 方式 1
    ook_obj = Book(id=1, title=&quot;python红宝书&quot;, price=100, pub_date=&quot;2012-12-12&quot;, publish=&quot;人民出版社&quot;)
    book_obj.save()

    # 方式 2 不用 save  create 返回值是录前生成记录的对象
    book_obj = Book.objects.create(title=&quot;php&quot;, price=100, pub_date=&quot;2012-12-12&quot;, publish=&quot;人民出版社&quot;)

    return HttpResponse(&quot;ok&quot;)
</code></pre></div><h4 id="表查询"><a href="#表查询" class="header-anchor">#</a> 表查询</h4> <p>和上面一样的代码这里没有写出来</p> <div class="language- extra-class"><pre class="language-text"><code>    # 查询   
    # 1 方法的返回值
    # 2 方法的调用者   objects 是管理器
    
    # all 方法  调用者是 objects 返回值 是一个 queryset 对象
    book_list = Book.objects.all()   # [obj1, obj2, ...]

    print(book_list)

    for obj in book_list:
        print(obj.title, obj.price)

    # first, last  调用者是queryset,  返值是 model对象
    book = Book.objects.all().first()
    # book = Book.objects.all()[0]


    # filter()  调用者是 objects 返回值 是一个 queryset 对象

    book_list = Book.objects.filter(price=100)  # [obj1, obj2, ...]
                                        # 它是一个queryset 所以可以调用 first, last
    book_list = Book.objects.filter(price=100, title=&quot;go&quot;)  
    # get  有且只有一个查询结果时才有意义, 即查出多条结果或没结果,报错.
    #      只能有且只有一条结果
    #      返回值是一个 model 对象
    book_obj = Book.objects.get(title=&quot;go&quot;)

    # exclude 调用者是objects 返回值 是一个queryset对象
    #         除了 title='go' 的值都返回来, 即是filer取反
    #         排除条件过滤
    ret = Book.objects.exclude(title=&quot;go&quot;)
   

    # order_by  调用者是queryset对象, 返回一个queryset对象
    Book.objects.all().order_by('-id')          # - 降序
    Book.objects.all().order_by('price', 'id')  # 可以按多个排序


    # reverse  反序


    # count() 调用者是queryset对象, 返回一个 int
    ret = Book.objects.all().count()


    # exist()

    ret = Book.objects.all()# 通这个,虽然可以判断,有没有记录但不好,它会把所有记录了出来
    ret = Book.objects.all().exists()  # 取一条, 快,省
    if ret:
        print(&quot;ok&quot;)

    # values 方法 调用者是queryset对象, 返回一个queryset
    #         但它里面不是一个个对象了,而是一个个字典了,
    #         values 里可以传多个字段

    ret =  Book.objects.all().values('price')

    # values_list 方法, 调用者 queryset 对象, 返回值 queryset 对象
    #           但它里面不是一个个对象了,而是一个个元组了,     
    #           values_list 里可以传多个字段

    ret =  Book.objects.all().values_list('price', 'title')

    # distinct

    ret = Book.objects.all().distinct()  # 没意义,不要这样用
    ret = Book.objects.all().values('price').distinct()  

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/Django/" class="prev router-link-active">
        Django
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a761fdad.js" defer></script><script src="/assets/js/2.f625eefe.js" defer></script><script src="/assets/js/19.57d5157d.js" defer></script>
  </body>
</html>
